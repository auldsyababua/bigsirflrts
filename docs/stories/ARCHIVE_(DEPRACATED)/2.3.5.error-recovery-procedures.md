# Story 2.3.5: Error Recovery & Fallback Procedures

## Story

**As a** field operations user  
**I want** clear fallback options when NLP parsing fails  
**So that** I can still complete critical tasks without switching apps

## Context

Internal operations require 100% task capture reliability. When NLP fails, users need immediate alternatives without leaving Telegram to maintain operational continuity.

## Acceptance Criteria

### Required

1. **Parse Failure Response**
   - [ ] On confidence < 80%, show:

     ```
     ⚠️ Low confidence parse (72%)
     
     I understood:
     Task: [parsed task]
     Assignee: [unclear - Taylor?]
     Due: [unclear - tomorrow?]
     
     Reply:
     • "confirm" → Create anyway
     • "fix: assignee is Colin" → Correct
     • /manual → Switch to form mode
     ```

2. **Complete Failure Fallback**
   - [ ] On total parse failure:

     ```
     ❌ Couldn't understand that
     
     Your input: "[original text]"
     
     Options:
     • Try rephrasing more clearly
     • Use /manual for guided entry
     • /force {"task":"...", "assignee":"..."}
     ```

3. **Manual Override Command**
   - [ ] Implement `/force` command accepting raw JSON
   - [ ] Validate JSON structure before submission
   - [ ] Log as manual entry for metrics

4. **Guided Manual Entry**
   - [ ] Implement `/manual` command with step-by-step:
     - Step 1: "What's the task?"
     - Step 2: "Who should do it?"
     - Step 3: "When is it due?"
     - Step 4: Show confirmation

5. **Failure Logging**
   - [ ] Log to `flrts.parse_failures` table:
     - Original input
     - Parse attempt response
     - Timestamp and user
     - Resolution method used
   - [ ] Weekly report of common failures for prompt tuning

### Testing

- [ ] Test with ambiguous inputs
- [ ] Test with non-English text
- [ ] Test with typos and abbreviations
- [ ] Verify fallback paths work on mobile

## Technical Notes

- All failures must be captured for continuous improvement
- Manual override maintains operational continuity
- No external redirects - keep users in Telegram

## Dependencies

- Depends on: Story 2.2 (OpenAI integration)
- Related to: Story 3.2 (Confirmation flow)

## Effort

- **Points**: 3
- **Risk**: Low (fallback patterns are straightforward)
- **Priority**: P1 - Critical for operations

## Definition of Done

- [ ] All three fallback methods implemented
- [ ] Parse failures logged to database
- [ ] 100% task capture maintained (via NLP or manual)
- [ ] Mobile-tested on iOS and Android
- [ ] Operations team trained on fallback commands
