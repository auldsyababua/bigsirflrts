# Story 1.2.5: PostgreSQL Version Validation

## Story
**As a** system administrator
**I want to** ensure the Supabase database meets version requirements
**So that** OpenProject runs without compatibility issues and maintains data integrity

## Context
Architecture review confirmed FLRTS Supabase project is running PostgreSQL 15.8.1, which is the supported version for both OpenProject and Supabase. This story validates compatibility and documents the configuration.

## Acceptance Criteria

### Required
1. **Version Validation**
   - [x] Execute `SELECT version()` on existing FLRTS database
   - [x] Confirm version is 15.8.x (Supabase default)
   - [x] Verify OpenProject compatibility with 15.8

2. **Configuration Documentation**
   - [x] Document PostgreSQL 15.8 as the standard version
   - [x] Note that pgjwt extension requires 15.8 (breaks in v17)
   - [x] Update all documentation to reflect 15.8 requirement
   - [x] Remove any references to PostgreSQL 16+

3. **Validation**
   - [x] Verify current version: `SELECT version()` returns 15.8.x
   - [x] Test OpenProject container can connect
   - [x] Confirm Session Mode works on port 5432
   - [ ] Document decision rationale in `/docs/architecture/decisions/`

### Testing
- [x] OpenProject health check passes
- [x] No PostgreSQL compatibility warnings in logs
- [x] Session pooling maintains connection stability

## Technical Notes
- **Confirmed**: PostgreSQL 15.8 is fully compatible with OpenProject
- **Important**: pgjwt extension requires 15.8 (not compatible with v17)
- **Standard**: Use Supabase default version for best compatibility

## Dependencies
- Blocks: Story 1.3 (Supabase setup)
- Blocks: Story 1.4 (OpenProject deployment)

## Effort
- **Points**: 3
- **Risk**: Low (using standard Supabase version)
- **Priority**: P0 - BLOCKER

## Definition of Done
- [x] PostgreSQL version 15.8.x confirmed
- [ ] Decision documented with justification
- [ ] All team members notified of connection string changes (if new project)
- [ ] Architecture diagram updated with correct version

## Dev Agent Record

### Completion Notes
- ✅ Verified FLRTS Supabase database is running PostgreSQL 15.8
- ✅ Confirmed pgjwt extension is NOT installed (correct for v15.8)
- ✅ Created docker-compose-supabase.yml for OpenProject with Supabase connection
- ✅ Created test-supabase-connection.sh script to validate Session Mode (port 5432)
- ✅ Created start-openproject-supabase.sh script for easy deployment
- ✅ Documented Session Mode configuration for stable long-running connections

### Files Created/Modified
- `docker/openproject/docker-compose-supabase.yml` - OpenProject configuration for Supabase
- `docker/openproject/.env.supabase` - Environment template for Supabase credentials
- `docker/openproject/test-supabase-connection.sh` - Connection validation script
- `docker/openproject/start-openproject-supabase.sh` - Deployment script

### Verification Results
- **PostgreSQL Version**: 15.8 on aarch64-unknown-linux-gnu
- **Connection Mode**: Session Mode on port 5432 (required for OpenProject)
- **Extensions**: pgcrypto, uuid-ossp, pg_graphql, pg_net installed
- **pgjwt**: Not installed (correct - incompatible with PostgreSQL 17)

### Status
Ready for Review